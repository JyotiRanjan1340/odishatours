<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Odisha Epics Tours Booking</title>
  <style>
    body { font-family: 'Poppins', Arial, sans-serif; background: #f8f9fa; }
    .container { max-width: 500px; margin: 40px auto; background: #fff; padding: 32px 24px; border-radius: 12px; box-shadow: 0 2px 18px #0001; }
    h2 { text-align: center; color: #1976d2; margin-bottom: 24px; }
    .form-group { margin-bottom: 18px; }
    label { display: block; font-weight: 500; margin-bottom: 7px; }
    input, select, textarea { width: 100%; padding: 9px; border: 1px solid #bbb; border-radius: 6px; font-size: 1rem; }
    input:invalid, textarea:invalid, select:invalid { border-color: #f44336; }
    .submit-btn { background: #1976d2; color: #fff; font-weight: 600; border: none; padding: 11px 0; width: 100%; border-radius: 6px; font-size: 1.1rem; cursor: pointer; }
    .submit-btn:hover { background: #145ea8; }
    .note { color: #999; font-size: 0.97rem; margin-top: -10px; margin-bottom: 14px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Book Your Odisha Tour</h2>
    <form id="bookingForm" autocomplete="off" novalidate>
      <div class="form-group">
        <label for="name">Full Name *</label>
        <input id="name" name="name" required minlength="2" maxlength="80" pattern=".{2,}" autocomplete="off">
      </div>
      <div class="form-group">
        <label for="email">Email Address *</label>
        <input id="email" name="email" type="email" required maxlength="80" pattern="^[^@\s]+@[^@\s]+\.[^@\s]+$" autocomplete="off">
        <div class="note">Must be a valid email id</div>
      </div>
      <div class="form-group">
        <label for="phone">Phone Number *</label>
        <input id="phone" name="phone" type="tel" required maxlength="10" minlength="10" pattern="^[6-9]\d{9}$" autocomplete="off">
        <div class="note">Must be a valid 10 digit Indian mobile number</div>
      </div>
      <div class="form-group">
        <label for="service">Service Required *</label>
        <select id="service" name="service" required>
          <option value="">Select a service</option>
          <option value="vehicle-rental">Vehicle Rental Only</option>
          <option value="guide-service">Personal Guide Service</option>
          <option value="security-service">Security Service</option>
          <option value="complete-package">Complete Tour Package</option>
        </select>
      </div>
      <div class="form-group">
        <label for="destination">Preferred Destinations</label>
        <select id="destination" name="destination">
          <option value="">Select destination</option>
          <option value="bhubaneswar">Bhubaneswar</option>
          <option value="puri">Puri</option>
          <option value="konark">Konark</option>
          <option value="chilika">Chilika Lake</option>
          <option value="similipal">Similipal National Park</option>
          <option value="custom">Custom Itinerary</option>
        </select>
      </div>
      <div class="form-group">
        <label for="guests">Number of Guests *</label>
        <input id="guests" name="guests" type="number" min="1" max="50" required>
        <div class="note">Number only, maximum 50</div>
      </div>
      <div class="form-group">
        <label for="date">Preferred Travel Date *</label>
        <input id="date" name="date" type="date" required>
        <div class="note">Must be today or a future date</div>
      </div>
      <div class="form-group">
        <label for="message">Special Requirements</label>
        <textarea id="message" name="message" rows="3" maxlength="400" autocomplete="off"></textarea>
      </div>
      <!-- Honeypot anti-spam field (hidden from humans) -->
      <div style="display:none;">
        <label>Leave this field empty</label>
        <input type="text" name="website">
      </div>
      <button type="submit" class="submit-btn">Submit Inquiry</button>
    </form>
  </div>

  <script>
    // Anti-spam: honeypot and JS validation
    document.getElementById('bookingForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      // Honeypot anti-spam check: if filled, block submission
      if (document.querySelector('input[name="website"]').value) {
        alert("Spam detected. Submission blocked.");
        return;
      }

      // Name validation
      const name = document.getElementById('name').value.trim();
      if (!name || name.length < 2) {
        alert('Please enter your full name.');
        return;
      }

      // Email validation
      const email = document.getElementById('email').value.trim();
      if (!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)) {
        alert('Enter a valid email address.');
        return;
      }

      // Phone validation (Indian mobile only)
      const phone = document.getElementById('phone').value.trim();
      if (!/^[6-9]\d{9}$/.test(phone)) {
        alert('Enter a valid 10-digit Indian mobile number starting with 6, 7, 8, or 9.');
        return;
      }

      // Service required validation
      const service = document.getElementById('service').value;
      if (!service) {
        alert('Please select a service.');
        return;
      }

      // Guests validation
      const guests = parseInt(document.getElementById('guests').value, 10);
      if (isNaN(guests) || guests < 1 || guests > 50) {
        alert('Number of guests must be between 1 and 50.');
        return;
      }

      // Date validation: must be today or future
      const dateInput = document.getElementById('date').value;
      if (!dateInput) {
        alert('Please select a travel date.');
        return;
      }
      const selectedDate = new Date(dateInput);
      const today = new Date();
      today.setHours(0,0,0,0);
      if (selectedDate < today) {
        alert('Travel date cannot be in the past.');
        return;
      }

      // Special requirements: optional, but max length
      const message = document.getElementById('message').value.trim();
      if (message.length > 400) {
        alert('Special requirements: maximum 400 characters allowed.');
        return;
      }

      // All validations passed. Submit to Apps Script
      const form = e.target;
      const data = new FormData(form);
      const params = new URLSearchParams(data);
      const url = "https://script.google.com/macros/s/AKfycbzm3vv9NHdx7Z8hx_2aN-oBJKhcITtFiAOBKwuU-R7mxE0ChaXyt65vko9XSlqJFgEE_A/exec";
      try {
        const response = await fetch(url, {
          method: "POST",
          body: params,
        });
        // Anti-spam: block duplicate rapid submissions
        form.querySelector('.submit-btn').disabled = true;
        setTimeout(() => {
          form.querySelector('.submit-btn').disabled = false;
        }, 9000);
        form.reset();
        alert(await response.text());
      } catch (err) {
        alert("Error submitting booking. Please try again.");
      }
    });
  </script>
</body>
</html>
